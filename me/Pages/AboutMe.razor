@page "/"

@inject IExcelFileService ExcelFileService

<PageTitle>gjmwolmarans.me | About Me</PageTitle>

<FluentStack Orientation="Orientation.Vertical">
    <h1>Hello, world!</h1>
    <p></p>
</FluentStack>

<h2>Competency Matrix</h2>

<div style="overflow: auto">
    <iframe width="1154" height="642" frameborder="0" scrolling="no" src="https://onedrive.live.com/embed?resid=F9480B74B852B3B7%21251307&authkey=%21ALWOWl3ShAlVT70&em=2&wdAllowInteractivity=False&Item=ClusterExperience&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True&edesNext=false&resen=false&ed1JS=false"></iframe>
</div>

<ResourceList />

@code {
    Data Data { get; set; } 

    protected async override Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
    }

    protected async override Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            Data = await ExcelFileService.LoadData(); 
            Console.WriteLine($"Resources ({Data.Resources.Count()})");
        }
    }
}